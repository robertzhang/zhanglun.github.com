<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>(译)Node.js的 EventEmitter 教程 | 张小伦爱学习</title>
  <meta name="author" content="张小伦爱学习">
  
  <meta name="description" content="原文标题：Node.js EventEmitter Tutorial 原文链接：http://www.hacksparrow.com/node-js-eventemitter-tutorial.html">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="(译)Node.js的 EventEmitter 教程"/>
  <meta property="og:site_name" content="张小伦爱学习"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="张小伦爱学习" type="application/atom+xml">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" type="text/css">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" type="text/css">
<link rel="stylesheet" href="/css/style.css" type="text/css">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-368771XX-X']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

</head>

<body>
  <header id="header" class='normal_mode'>
    <nav id="main-nav">
  <ul class='container'>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">存档</a></li>
    
      <li><a href="http://ncuey.sinaapp.com/CrispElite/">关于</a></li>
    
      <li><a href="https://github.com/zhanglun">Github</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
  </header>
  <div id="content" class="container">
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2014-05-05T13:23:00.000Z"><a href="/2014/05/05/(译)Node.js 的 EventEmitter 教程/">周一, 5月 5 2014, 9:23:00 晚上</a></time>

  
    <h1 class="title">(译)Node.js的 EventEmitter 教程</h1>
  



  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/译文/">译文</a>, <a href="/tags/Node.js/">Node.js</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <blockquote>
<p>原文标题：Node.js EventEmitter Tutorial<br> 原文链接：<a href="http://www.hacksparrow.com/node-js-eventemitter-tutorial.html" target="_blank">http://www.hacksparrow.com/node-js-eventemitter-tutorial.html</a></p>
</blockquote>
<a id="more"></a>

<p>听说过 Node.js 中的 <code>EventEmitter</code> 吗？也许你知道大部分内置的 Node.js 库 都使用它，也许你总是对 <code>EventEmitter</code> 充满好奇，但是没有谁向你解释？</p>
<p>在这个教程中，我会给你一些关于 <code>EventEmitter</code> 类的例子。</p>
<p>你必须熟悉各种 Node.js 中的事件比如： <code>on data</code> ， <code>on end</code> ， <code>on error</code> 等等之类的。事件机制的工作做得天衣无缝，十分完美，难道不是吗？所有的基于事件的 Node.js 库都依赖于 <code>EventEmitter</code> 类，你可能会说那些库都继承了 <code>EventEmitter</code>。</p>
<p> <code>EventEmitter</code> 的强大之处不仅限于内置的 Node.js 库，你也可以拥有它！</p>
<p>展示 <code>EventEmitter</code> 能力的最好方法就是通过一个例子，看看这个：</p>
<pre><code><span class="keyword">var</span> EventEmitter = <span class="built_in">require</span>(<span class="string">'events'</span>).EventEmitter;
<span class="keyword">var</span> radium = <span class="keyword">new</span> EventEmitter();

<span class="comment">//绑定 radiation 事件</span>
radium.on(<span class="string">'radiation'</span>, <span class="function"><span class="keyword">function</span><span class="params">(ray)</span> {</span>
    console.log(ray);
});

setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="comment">//触发 radiation 事件</span>
    radium.emit(<span class="string">'radiation'</span>, <span class="string">'GAMMA'</span>);
}, <span class="number">1000</span>);
</code></pre><p>注意到了吧，创建一个事件，添加一个事件监听器，触发事件，通过事件传递数据是多么的简单。所有的这些因为 <code>EventEmitter</code> 的魔力而实现。 <code>EventEmitter</code> 让编写令人惊讶的 Node.js 库变得可能。</p>
<p>上面的例子基于一个 <code>EventEmitter</code> 的实例，我们怎么做才能创建一个继承自 <code>EventEmitter</code> 的类呢？Node.js 有一个，叫做 <code>util</code> 的库，它有一个方法： <code>inherits</code>，实现对象之间原型继承的函数。我们可以很轻松的通过它让一个类继承另一个类（准确的说不能叫类）：</p>
<pre><code><span class="keyword">var</span> util = <span class="built_in">require</span>(<span class="string">'util'</span>);
util.inherits(MyClass, SuperClass);
</code></pre><p>使用 <code>util.inherits()</code> ，我们创建了一个继承自 <code>EventEmitter</code> 的模块，注意下面的代码：</p>
<p><em>radio.js</em> 中的内容：</p>
<pre><code><span class="keyword">var</span> util = <span class="keyword">require</span>(<span class="string">'util'</span>);
<span class="keyword">var</span> EventEmitter = <span class="keyword">require</span>(<span class="string">'events'</span>).EventEmitter;

<span class="comment">//一个包含 "freq" 和 "name" 属性的对象</span>
<span class="keyword">var</span> Radio = <span class="function"><span class="keyword">function</span><span class="params">(station)</span> {</span>
    <span class="comment">//保存 指向Radio的this，在setTimeout()中使用</span>
    <span class="keyword">var</span> <span class="keyword">self</span> = this;

    setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">self</span>.emit(<span class="string">'open'</span>, station);
    }, <span class="number">0</span>);

    setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">self</span>.emit(<span class="string">'close'</span>, station);
    }, <span class="number">5000</span>);

    this.on(<span class="string">'newListener'</span>, <span class="function"><span class="keyword">function</span><span class="params">(listener)</span> {</span>
        console.log(<span class="string">'Event Listener: '</span> + listener);
    });

};

<span class="comment">//Radio 继承 EventEmitter</span>
util.inherits(Radio, EventEmitter);
module.exports = Radio;
</code></pre><p>我们创建了一个继承自 <code>EventEmitter</code> 的模块。接下来让我们看看如何在一个例子中使用创建的模块。</p>
<p><em>example.js</em> 中的内容：</p>
<pre><code><span class="keyword">var</span> Radio = <span class="built_in">require</span>(<span class="string">'./radio.js'</span>);

<span class="keyword">var</span> station = {
    freq: <span class="string">'80.16'</span>,
    name: <span class="string">'Rock N Roll Radio'</span>,
};
<span class="comment">// 创建一个Radio实例</span>
<span class="keyword">var</span> radio = <span class="keyword">new</span> Radio(station);

<span class="comment">//添加一个“open”事件监听器</span>
radio.on(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span><span class="params">(station)</span> {</span>
    console.log(<span class="string">'"%s" FM %s OPENED'</span>, station.name, station.freq);
    console.log(<span class="string">'? ??'</span>);
});

<span class="comment">//添加一个“close”事件监听器</span>
radio.on(<span class="string">'close'</span>, <span class="function"><span class="keyword">function</span><span class="params">(station)</span> {</span>
    console.log(<span class="string">'"%s" FM %s CLOSED'</span>, station.name, station.freq);
});
</code></pre><p>运行 example.js 准备好见证 <code>EventEmitter</code> 的魔力。</p>
<p>如果因为某些原因你不想使用 <code>util</code> 模块，你可以用这种方法来拓展一个类。</p>
<pre><code>Apple.<span class="keyword">prototype</span> = Object.create(<span class="keyword">require</span>(<span class="string">'events'</span>).EventEmitter.<span class="keyword">prototype</span>);
</code></pre><p> <code>EventEmitter</code> 可以帮你编写令人印象深刻的基于事件的 Node.js 模块。同时，作为作为一个 Node.js 的开发人员，你掌握的关于<code>EventEmitter</code>的知识会大大影响你的工作效率。所以，确保你阅读了<a href="http://nodejs.org/api/events.html#events_class_events_eventemitter" target="_blank">关于 <code>EventEmitter</code> 的更详细的资料</a>，并且掌握里里外外它是如何工作的。如果你不了解<code>EventEmitter</code>，那你也不了解 Nodejs.js</p>
<p>(完)</p>
<p><strong>翻译水平有待提高，所翻译的博文并不是按照原文一句一句翻译，而是添加了自己对文章的理解。如有不正之处，欢迎指正！</strong><br><strong>个人笔记，仅供参考。</strong></p>
<blockquote>
<p>参考:<br><a href="http://www.hacksparrow.com/node-js-eventemitter-tutorial.html">http://www.hacksparrow.com/node-js-eventemitter-tutorial.html
</a></p>
</blockquote>

      
    </div>
    <footer>
      
          
<!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <span class="jiathis_txt">分享到：</span>
  <a class="jiathis_button_weixin">微信</a>
  <a class="jiathis_button_tsina">新浪微博</a>
  <a class="jiathis_button_renren">人人网</a>
  <a class="jiathis_button_qzone">QQ空间</a>
  <a class="jiathis_button_douban">豆瓣</a>
  <a class="jiathis_button_pocket">Pocket</a>
  <a href="http://www.jiathis.com/share?uid=901656" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" src="http://v3.jiathis.com/code_mini/jia.js?uid=901656" charset="utf-8"></script>
<!-- JiaThis Button END -->

          <div class="clearfix"></div>
          <nav id="pagination">
  
    <a href="/2014/05/08/学习sass时了解到的一些好玩特性/" class="alignleft prev"><i class="fa fa-long-arrow-left"></i>Next</a>
  
  
    <a href="/2014/04/28/(译)Node.js的全局变量/" class="alignright next">Prev<i class="fa fa-long-arrow-right"></i></a>
  
  <div class="clearfix"></div>
</nav>
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      
  
</section>



    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div>
  
  &copy; 2014 张小伦爱学习
  
</div>
Powered by <a href="http://zespia.tw/hexo/" title="Hexo" target="_blank" rel="external">Hexo</a> and <a href="http://pages.github.com/" title="GitHub Pages" target="_blank" rel="external">GitHub Pages</a>

<div class="clearfix"></div></footer>
  
<script type="text/javascript" src="/js/jquery.imagesloaded.min.js"></script>
<script type="text/javascript" src="/js/gallery.js"></script>
<script type="text/javascript" src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>




    <script type="text/javascript">
        (function(){

            $(window).scroll(function(){

                var scrollTop = $(window).scrollTop();
                if ( scrollTop >200 ){
                    $("#main-nav").removeClass('normal_mode').addClass('top_mode');
                } else{
                    $("#main-nav").removeClass('top_mode').addClass('normal_mode');
                }

            });

        })();
    </script>



  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
  (function($){
    $('.fancybox').fancybox({
      'titlePosition': 'inside'
    });
  })(jQuery);
  </script>



    
    <script type="text/javascript">
      var duoshuoQuery = {short_name:"your_id"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = 'http://static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0] 
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



<script type="text/javascript">
  
  $(function(){

    $('.title').hover(
      function() {      
        $(this).stop().animate(
          {'marginLeft': '10px'}, 200
        );   
      }, 
      function() {       
        $(this).stop().animate({'marginLeft': '0px'}, 200);      
      
    });   

  });

</script>


</body>
</html>